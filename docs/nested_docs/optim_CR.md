# Selection of confound correction strategy

This page relates the set of confound correction strategies to relevant quality issues observed through the scan diagnosis and group quality reports, and is designed to support selecting ideal additional corrections to improve analysis quality.

In the table below, the correction strategies are listed in the recommended order of priority (i.e. which one should be attempted first). The confound correction operations are described elsewhere in the [confound correction pipeline](confound_pipeline_target).


| Correction strategy (# priority order)                                      | Data quality issue(s)                                                                                                                                                                                                  | Additional considerations                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
|-----------------------------------------------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| Framewise displacement censoring (#1)  <br>`--frame_censoring FD_censoring` | Spikes in the framewise displacement timecourse.                                                                                                                                                                       | Generally recommended, since frames exceeding motion thresholds can be too<br> corrupted for recovery post-processing, and represent an important concern for<br> spurious effects {cite}`Power2012-ji`.                                                                                                                                                                                                                                                                                                                                              |
| 6 motion parameters regression (#2)  <br>`--conf_list mot_6`                | Fluctuations in the 6 motion parameters associated to shifts in<br> signal from the carpet plot and/or network timecourses.                                                                                            | Generally recommended, unless there is a specific contra-indication (e.g. unreliable<br> motion estimation).                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| DVARS censoring (#3)  <br>`--frame_censoring DVARS_censoring`               | DVARS spikes (not explained by framewise displacement) are<br> affecting the network timecourses.                                                                                                                      |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| Highpass (#4)  <br>`--highpass`                                             | Global signal drifts can be observed from the carpet plot.                                                                                                                                                             | It is recommended to ~30sec at each edge of the timeseries with highpass. Other<br> strategies may be considered before highpass if the timeseries are already short.                                                                                                                                                                                                                                                                                                                                                                                 |
| ICA-AROMA (#5)  <br>`--ica_aroma`                                           | Disturbances in the $BOLD_{SD}$ and/or $GS_{cov}$ maps.                                                                                                                                                                | - The dimensionality of the ICA decomposition should not be unreasonably high<br> (ideally ~10-20 components per scan). This can be assessed by inspecting the<br> AROMA report in *confound_correction_datasink/aroma_out*. If dimensionality is<br> high, AROMA can be re-attempted with a pre-defined number of components<br> `dim=X`. <br> - Classification accuracy can be unpredictable and vary across datasets. Make sure<br> the correction did not impact network detectability, and ideally, inspect the AROMA<br> classification report. |
| aCompCor regression (#6)  <br>`--conf_list aCompCor_percent`/`aCompCor_5`   | - Disturbances in the $BOLD_{SD}$ and/or $GS_{cov}$ maps. <br> - Low network detectability <br> - High scan-level conf. corr.                                                                                          | - This regression strategy is considered first, as it is most likely to yield important<br> improvements for both motion and physiological confounds. <br> - aCompCor can be performed by either regressing timecourses from the first 5 PCA<br> component, or from the set of first components explaining 50% of the variance. If the<br> later is selected, the decomposition should be inspected to ensure that the<br> dimensionality is sensible.                                                                                                |
| WM/CSF regression (#7)  <br>`--conf_list WM_signal CSF_signal`              | - Physiological or global signatures in the $BOLD_{SD}$ and/or<br> $GS_{cov}$ maps. <br> - High scan-level conf. corr.                                                                                                 | The regression of WM/CSF signal can be considered in combination with aCompCor<br> is disturbances persist in the $GS_{cov}$.                                                                                                                                                                                                                                                                                                                                                                                                                         |
| 24 motion parameters regression (#8)  <br>`--conf_list mot_24`              | - Motion visible from the 6 motion parameters. <br> - Motion signatures in the $BOLD_{SD}$ and/or $GS_{cov}$ maps<br> or with the group inter-scan SD. <br> - High group correlation with mean framewise displacement. | - Extra motion regression is considered later, as previous correction strategies may<br> be more efficient at correcting motion.  <br> - Consider the impact on tDOF.                                                                                                                                                                                                                                                                                                                                                                                 |
| Homogenize $BOLD_{SD}$ (#9)  <br>`--scale_variance_voxelwise`               | - Disturbances in the $BOLD_{SD}$ and/or $GS_{cov}$ maps are<br> persisting despite previous corrections. <br> - Low network detectability.                                                                            | This technique is considered after regression strategies, as it does not remove<br> confounds, but only scales down the contribution of high-variance voxels.                                                                                                                                                                                                                                                                                                                                                                                         |
| Lowpass (#10)  <br>`--lowpass`                                              | High spectral power observed in the high frequency range.                                                                                                                                                              | - Lowpass is considered later as it can reduce network detectability. <br> - Lowpass will increase temporal correlations, and thus conf. corr. measures will be<br> inflated. Thresholds for this metric must be reconsidered accordingly.                                                                                                                                                                                                                                                                                                            |
| Global signal regression (#11)  <br>`--conf_list global_signal`             | High confound correlations at the scan or group level.                                                                                                                                                                 | Global signal removal can have an important impact on network detectability, likely<br> removing network activity as detected by $GS_{cov}$. Larger sample sizes are likely<br> necessary to retain sufficient statistical power.                                                                                                                                                                                                                                                                                                                     |
| Outlier removal (#12)  <br>`--scan_list`                                    | Outliers are observed from the datasets distribution plots and are<br> driving a group-wise confound correlation.                                                                                                      | The scan ID of outliers can be identified in `data_diagnosis_datasink/analysis_QC`<br> `/analysis_QC/sample_distributions/*_outlier_detection.csv`, and should then<br> removed from the group by specifying `--scan_list`                                                                                                                                                                                                                                                                                                                            |
| tDOF matching (#13)  <br>`--match_number_timepoints`                        | tDOF is correlated with connectivity at the group level.                                                                                                                                                               | This correction will likely reduce tDOF in several scans to enforce the same number<br> across scan. This is considered last to attempt preserving tDOF with other<br> corrections.                                                                                                                                                                                                                                                                                                                                                                   |



## Examples of quality issues from 

* DVARS spike
* GS/BOLDsd disturbances
* 
