# Analysis

Following the completion of the confound correction workflow, RABIES also integrates several options for standard resting-state connectivity analysis: seed-based connectivity, whole-brain connectivity, group independent component analysis (ICA) and dual regression (DR).

## Correlation-based analyses
- `--seed_list` : **Seed-based connectivity** is the first analysis technique applied for the analysis of connectivity at the resting state {cite}`Biswal1995-vh`. It consists of extracting the timecourse from an anatomical seed of interest (the mean timecourse is used in RABIES) and then measuring the correlation (Pearson’s r in RABIES) between this timecourse and every other voxel to obtain a correlation map, indicative of the ‘connectivity strength’ between the seed and every other brain regions. In RABIES, the correlation map for each provided seed is evaluated for all selected scans individually, providing scan-specific connectivity maps. Pearson’s r measures should be usually Z-transformed for most statistical applications, but since statistics are not provided within RABIES, the original Pearson’s r are provided.
- `--FC_matrix`/`--ROI_type` : The **whole-brain connectivity matrix** is an extension of the seed-based connectivity technique to encompass every brain region. That is, using the anatomical parcellation provided along with an input atlas, the seed timecourse for every parcel is first extracted, and then the cross-correlation (Pearson’s r) is measured between every region pair. The correlation values are then re-organized into a whole-brain matrix representing the ‘connectivity strength’ between every corresponding region pair. This holistic analysis approach allows the study of what has been referred to as the ‘connectome’, that is, the entire connectivity describing functional communications across the brain (as assessed through fMRI){cite}`Biswal2010-pi`. In RABIES, a whole-brain matrix is derived for each selected individual scan for later group analysis.

## ICA-based analyses
The next two analyses rely on the spatial decomposition of BOLD timeseries using ICA, which models the data as a linear combination of independent sources. This approach is conceptually very different from the previously described correlation-based analyses, which account for a single linear relationship between regions, whereas ICA estimates simultaneous and potentially spatially-overlapping relationships. This latter feature can be particularly useful for providing further robustness to remaining confounds, which can overlap spatially and temporally with BOLD signal of interest (see example ICA outputs in sup. Fig. X).
- `--group_ICA`/`--dim`/`--melodic_random_seed` : **Group ICA** is conducted based on FSL’s MELODIC ICA algorithm {cite}`Beckmann2004-yw` on concatenated timeseries from a selection of (or all) scans, aligned in commonspace. Group ICA is used to identify spatial sources of covariance (components) prevalent in the dataset, among which are commonly found resting-state networks. 
- `--prior_maps`/`--DR_ICA` : **Dual regression (DR)** is a technique building on the group ICA algorithm which allows the modelling of previously detected group-level components back onto single scans {cite}`Beckmann2009-cf,Nickerson2017-gq`. The DR algorithm consists, as the name implies, of two consecutive linear regression steps, where components from group ICA are first regressed against an individual scan timeseries to obtain an associated timecourse for each component, and a second regression using these timecourses, again against the scan’s timeseries, allow to finally derive scan-specific spatial maps for each corresponding ICA component. These individual maps are useful for evaluating how features of resting-state networks, such as amplitude or spatial location, might differ across groups or subjects {cite}`Nickerson2017-gq`.
